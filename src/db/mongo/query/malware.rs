use mongodb::bson::doc;

use crate::routes::malware::MalwareQuery;

use super::DbQuery;

impl DbQuery for MalwareQuery {
    fn to_doc(&self) -> mongodb::bson::Document {
        let mut doc = doc! {};
        if let Some(id) = &self.mid {
            let regex = doc! {
            "$regex": id,
            "$options": "i"
            };
            doc.insert("mid", regex);
        }
        if let Some(value) = &self.desc {
            let regex = doc! {
            "$regex": value,
            "$options": "i"
            };
            doc.insert("description", regex);
        }
        doc
    }
}
